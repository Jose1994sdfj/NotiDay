<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Dashboard Personal</title>
    <style>
        :root {
            --primary: #667eea;
            --primary-light: #764ba2;
            --secondary: #f093fb;
            --success: #4facfe;
            --warning: #f093fb;
            --error: #ff6b6b;
            --light: #f8fafc;
            --dark: #1a202c;
            --gray: #718096;
            --gray-light: #e2e8f0;
            --bg-color: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --card-bg: rgba(255, 255, 255, 0.95);
            --shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            --shadow-hover: 0 20px 40px rgba(0, 0, 0, 0.15);
            --border-radius: 20px;
        }

        .dark-mode {
            --bg-color: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
            --card-bg: rgba(45, 55, 72, 0.95);
            --light: #2d3748;
            --dark: #f7fafc;
            --gray-light: #4a5568;
            --shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            --shadow-hover: 0 20px 40px rgba(0, 0, 0, 0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-color);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header mejorado */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 30px 0;
            margin-bottom: 40px;
        }

        .header-content h1 {
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 5px;
        }

        .header-subtitle {
            color: var(--gray);
            font-size: 1.1rem;
            opacity: 0.8;
        }

        .header-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .theme-toggle, .btn-primary {
            background: linear-gradient(45deg, var(--primary), var(--primary-light));
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 50px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: var(--shadow);
        }

        .theme-toggle:hover, .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        /* Grid mejorado */
        .widgets-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .widget {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .widget::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }

        .widget:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }

        .widget-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--gray-light);
        }

        .widget-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .widget-icon {
            font-size: 1.5rem;
        }

        /* Estilos mejorados para tareas */
        .task-input {
            display: flex;
            margin-bottom: 20px;
            gap: 10px;
        }

        .task-input input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid var(--gray-light);
            border-radius: 12px;
            background-color: var(--light);
            color: var(--dark);
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .task-input input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .task-input button {
            padding: 12px 20px;
            background: linear-gradient(45deg, var(--primary), var(--primary-light));
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .task-list {
            list-style: none;
            max-height: 400px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--primary) var(--light);
        }

        .task-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid var(--gray-light);
            transition: all 0.3s ease;
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .task-item:hover {
            background-color: var(--light);
            transform: translateX(5px);
        }

        .task-item.completed {
            opacity: 0.6;
        }

        .task-item.completed span {
            text-decoration: line-through;
            color: var(--gray);
        }

        .task-actions button {
            background: none;
            border: none;
            cursor: pointer;
            margin-left: 8px;
            color: var(--gray);
            padding: 8px;
            border-radius: 6px;
            transition: all 0.3s ease;
        }

        .task-actions button:hover {
            background-color: var(--primary);
            color: white;
        }

        /* Timer Pomodoro mejorado */
        .timer-display {
            text-align: center;
            font-size: 4rem;
            font-weight: 800;
            margin: 30px 0;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .timer-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .timer-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            min-width: 100px;
        }

        .start-btn {
            background: linear-gradient(45deg, #4facfe, #00f2fe);
            color: white;
        }

        .pause-btn {
            background: linear-gradient(45deg, #ffecd2, #fcb69f);
            color: #8b4513;
        }

        .reset-btn {
            background: linear-gradient(45deg, #a8edea, #fed6e3);
            color: #666;
        }

        .timer-progress {
            width: 100%;
            height: 8px;
            background-color: var(--gray-light);
            border-radius: 4px;
            overflow: hidden;
        }

        .timer-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            transition: width 1s ease;
        }

        /* Notas mejoradas */
        .notes-container {
            display: grid;
            gap: 15px;
            max-height: 400px;
            overflow-y: auto;
        }

        .note {
            background: var(--light);
            padding: 18px;
            border-radius: 12px;
            position: relative;
            border-left: 4px solid var(--primary);
            transition: all 0.3s ease;
        }

        .note:hover {
            transform: translateX(3px);
            box-shadow: var(--shadow);
        }

        .note-content {
            margin-right: 60px;
            word-break: break-word;
        }

        .note-actions {
            position: absolute;
            top: 15px;
            right: 15px;
            display: flex;
            gap: 5px;
        }

        /* Widget de Metas */
        .goals-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .goal-item {
            background: var(--light);
            padding: 18px;
            border-radius: 12px;
            margin-bottom: 15px;
            border-left: 4px solid var(--primary);
        }

        .goal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .goal-title {
            font-weight: 600;
            color: var(--dark);
        }

        .goal-progress {
            width: 100%;
            height: 8px;
            background-color: var(--gray-light);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 5px;
        }

        .goal-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--success), var(--primary));
            transition: width 0.3s ease;
        }

        .goal-percentage {
            font-size: 0.9rem;
            color: var(--gray);
        }

        /* Widget de Calendario */
        .calendar-widget {
            min-height: 450px;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .calendar-nav {
            display: flex;
            gap: 10px;
        }

        .calendar-nav button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            margin-bottom: 20px;
        }

        .calendar-day-header {
            text-align: center;
            font-weight: 600;
            padding: 8px;
            color: var(--gray);
            font-size: 0.9rem;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .calendar-day:hover {
            background-color: var(--primary);
            color: white;
        }

        .calendar-day.today {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            font-weight: bold;
        }

        .calendar-day.has-event::after {
            content: '';
            position: absolute;
            bottom: 2px;
            left: 50%;
            transform: translateX(-50%);
            width: 6px;
            height: 6px;
            background-color: var(--warning);
            border-radius: 50%;
        }

        .events-list {
            max-height: 200px;
            overflow-y: auto;
        }

        .event-item {
            background: var(--light);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 8px;
            border-left: 3px solid var(--primary);
        }

        /* Clima mejorado */
        .weather-info {
            text-align: center;
        }

        .weather-icon {
            font-size: 4rem;
            margin-bottom: 15px;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.1));
        }

        .temperature {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 10px;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .weather-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .weather-detail {
            background: var(--light);
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .weather-detail:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        /* Modales */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: var(--card-bg);
            margin: 10% auto;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            box-shadow: var(--shadow-hover);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .close {
            color: var(--gray);
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: var(--dark);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }

        .form-group input, .form-group textarea, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--gray-light);
            border-radius: 8px;
            background-color: var(--light);
            color: var(--dark);
            transition: all 0.3s ease;
        }

        .form-group input:focus, .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .widgets-grid {
                grid-template-columns: 1fr;
            }

            .header-content h1 {
                font-size: 2rem;
            }

            .timer-display {
                font-size: 2.5rem;
            }

            .temperature {
                font-size: 2rem;
            }

            .modal-content {
                width: 95%;
                margin: 5% auto;
                padding: 20px;
            }
        }

        /* Animaciones */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        .slide-in {
            animation: slideIn 0.3s ease-out;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <h1>Dashboard Personal</h1>
                <p class="header-subtitle">Organiza tu día de manera inteligente</p>
            </div>
            <div class="header-actions">
                <button class="theme-toggle" id="themeToggle">
                    <span>Modo Oscuro</span>
                    <i>🌙</i>
                </button>
            </div>
        </header>

        <div class="widgets-grid">
            <!-- Widget de Tareas Mejorado -->
            <div class="widget">
                <div class="widget-header">
                    <h2 class="widget-title">
                        <span class="widget-icon">📋</span>
                        Lista de Tareas
                    </h2>
                </div>
                <div class="task-input">
                    <input type="text" id="taskInput" placeholder="¿Qué necesitas hacer hoy?">
                    <button id="addTaskBtn">Agregar</button>
                </div>
                <ul class="task-list" id="taskList"></ul>
            </div>

            <!-- Widget de Pomodoro Mejorado -->
            <div class="widget">
                <div class="widget-header">
                    <h2 class="widget-title">
                        <span class="widget-icon">🍅</span>
                        Temporizador Pomodoro
                    </h2>
                </div>
                <div class="timer-display" id="timerDisplay">25:00</div>
                <div class="timer-progress">
                    <div class="timer-progress-bar" id="timerProgressBar"></div>
                </div>
                <div class="timer-controls">
                    <button class="timer-btn start-btn" id="startBtn">Iniciar</button>
                    <button class="timer-btn pause-btn" id="pauseBtn">Pausar</button>
                    <button class="timer-btn reset-btn" id="resetBtn">Reiniciar</button>
                </div>
            </div>

            <!-- Widget de Metas (Nuevo) -->
            <div class="widget">
                <div class="widget-header">
                    <h2 class="widget-title">
                        <span class="widget-icon">🎯</span>
                        Mis Metas
                    </h2>
                    <button class="btn-primary" id="addGoalBtn">+ Nueva Meta</button>
                </div>
                <div class="goals-list" id="goalsList"></div>
            </div>

            <!-- Widget de Calendario (Nuevo) -->
            <div class="widget calendar-widget">
                <div class="widget-header">
                    <h2 class="widget-title">
                        <span class="widget-icon">📅</span>
                        Calendario
                    </h2>
                    <button class="btn-primary" id="addEventBtn">+ Evento</button>
                </div>
                <div class="calendar-header">
                    <h3 id="currentMonth"></h3>
                    <div class="calendar-nav">
                        <button id="prevMonth">◀</button>
                        <button id="nextMonth">▶</button>
                    </div>
                </div>
                <div class="calendar-grid" id="calendarGrid"></div>
                <div class="events-list" id="eventsList"></div>
            </div>

            <!-- Widget de Notas Mejorado -->
            <div class="widget">
                <div class="widget-header">
                    <h2 class="widget-title">
                        <span class="widget-icon">📝</span>
                        Notas Rápidas
                    </h2>
                    <button class="btn-primary" id="addNoteBtn">+ Nueva Nota</button>
                </div>
                <div class="notes-container" id="notesContainer"></div>
            </div>

            <!-- Widget de Clima Mejorado -->
            <div class="widget">
                <div class="widget-header">
                    <h2 class="widget-title">
                        <span class="widget-icon">🌤️</span>
                        Clima
                    </h2>
                </div>
                <div class="weather-info" id="weatherInfo">
                    <p>Haz clic para obtener el clima actual</p>
                    <button class="btn-primary" id="getWeatherBtn">Obtener Clima</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Metas -->
    <div id="goalModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="goalModalTitle">Nueva Meta</h2>
                <span class="close" id="closeGoalModal">&times;</span>
            </div>
            <form id="goalForm">
                <input type="hidden" id="goalId">
                <div class="form-group">
                    <label for="goalTitle">Título de la Meta</label>
                    <input type="text" id="goalTitle" required>
                </div>
                <div class="form-group">
                    <label for="goalDescription">Descripción</label>
                    <textarea id="goalDescription" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label for="goalTarget">Meta Objetivo</label>
                    <input type="number" id="goalTarget" min="1" required>
                </div>
                <div class="form-group">
                    <label for="goalCurrent">Progreso Actual</label>
                    <input type="number" id="goalCurrent" min="0" value="0">
                </div>
                <button type="submit" class="btn-primary" id="goalSubmitBtn">Crear Meta</button>
            </form>
        </div>
    </div>

    <!-- Modal para Eventos -->
    <div id="eventModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Nuevo Evento</h2>
                <span class="close" id="closeEventModal">&times;</span>
            </div>
            <form id="eventForm">
                <div class="form-group">
                    <label for="eventTitle">Título del Evento</label>
                    <input type="text" id="eventTitle" required>
                </div>
                <div class="form-group">
                    <label for="eventDate">Fecha</label>
                    <input type="date" id="eventDate" required>
                </div>
                <div class="form-group">
                    <label for="eventTime">Hora</label>
                    <input type="time" id="eventTime">
                </div>
                <div class="form-group">
                    <label for="eventDescription">Descripción</label>
                    <textarea id="eventDescription" rows="3"></textarea>
                </div>
                <button type="submit" class="btn-primary">Crear Evento</button>
            </form>
        </div>
    </div>

    <!-- Modal para Notas -->
    <div id="noteModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="noteModalTitle">Nueva Nota</h2>
                <span class="close" id="closeNoteModal">&times;</span>
            </div>
            <form id="noteForm">
                <input type="hidden" id="noteId">
                <div class="form-group">
                    <label for="noteContent">Contenido de la Nota</label>
                    <textarea id="noteContent" rows="5" required></textarea>
                </div>
                <button type="submit" class="btn-primary" id="noteSubmitBtn">Guardar Nota</button>
            </form>
        </div>
    </div>

    <script>
        // Variables globales
        let tasks = JSON.parse(localStorage.getItem('tasks')) || [];
        let notes = JSON.parse(localStorage.getItem('notes')) || [];
        let goals = JSON.parse(localStorage.getItem('goals')) || [];
        let events = JSON.parse(localStorage.getItem('events')) || [];
        let currentDate = new Date();
        let timer = null;
        let isRunning = false;
        let minutes = 25;
        let seconds = 0;
        let totalTime = 25 * 60;
        let editingGoalIndex = -1;
        let editingNoteIndex = -1;

        // Gestión del tema
        const themeToggle = document.getElementById('themeToggle');
        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            updateThemeButton();
            savePreferences();
        });

        function updateThemeButton() {
            if (document.body.classList.contains('dark-mode')) {
                themeToggle.innerHTML = '<span>Modo Claro</span> <i>☀️</i>';
            } else {
                themeToggle.innerHTML = '<span>Modo Oscuro</span> <i>🌙</i>';
            }
        }

        function loadPreferences() {
            const darkMode = localStorage.getItem('darkMode') === 'true';
            if (darkMode) {
                document.body.classList.add('dark-mode');
                updateThemeButton();
            }
        }

        function savePreferences() {
            localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
        }

        // Gestión de Tareas Mejorada
        const taskInput = document.getElementById('taskInput');
        const addTaskBtn = document.getElementById('addTaskBtn');
        const taskList = document.getElementById('taskList');

        function renderTasks() {
            taskList.innerHTML = '';
            tasks.forEach((task, index) => {
                const li = document.createElement('li');
                li.className = `task-item ${task.completed ? 'completed' : ''} fade-in`;
                li.innerHTML = `
                    <span>${task.text}</span>
                    <div class="task-actions">
                        <button class="complete-btn" title="${task.completed ? 'Marcar como pendiente' : 'Marcar como completada'}">${task.completed ? '↶' : '✓'}</button>
                        <button class="delete-btn" title="Eliminar tarea">✕</button>
                    </div>
                `;
                taskList.appendChild(li);

                li.querySelector('.complete-btn').addEventListener('click', () => toggleTask(index));
                li.querySelector('.delete-btn').addEventListener('click', () => deleteTask(index));
            });
            saveTasks();
        }

        function addTask() {
            const text = taskInput.value.trim();
            if (text) {
                tasks.unshift({ text, completed: false, createdAt: new Date().toISOString() });
                taskInput.value = '';
                renderTasks();
            }
        }

        function toggleTask(index) {
            tasks[index].completed = !tasks[index].completed;
            renderTasks();
        }

        function deleteTask(index) {
            tasks.splice(index, 1);
            renderTasks();
        }

        function saveTasks() {
            localStorage.setItem('tasks', JSON.stringify(tasks));
        }

        addTaskBtn.addEventListener('click', addTask);
        taskInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') addTask();
        });

        // Temporizador Pomodoro Mejorado
        const timerDisplay = document.getElementById('timerDisplay');
        const timerProgressBar = document.getElementById('timerProgressBar');
        const startBtn = document.getElementById('startBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const resetBtn = document.getElementById('resetBtn');

        function updateTimerDisplay() {
            timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            const elapsed = totalTime - (minutes * 60 + seconds);
            const progress = (elapsed / totalTime) * 100;
            timerProgressBar.style.width = `${progress}%`;
        }

        function startTimer() {
            if (!isRunning) {
                isRunning = true;
                timer = setInterval(() => {
                    if (seconds === 0) {
                        if (minutes === 0) {
                            clearInterval(timer);
                            isRunning = false;
                            showNotification('¡Tiempo completado!', '🍅 ¡Excelente trabajo! Toma un descanso.');
                            return;
                        }
                        minutes--;
                        seconds = 59;
                    } else {
                        seconds--;
                    }
                    updateTimerDisplay();
                }, 1000);
            }
        }

        function pauseTimer() {
            clearInterval(timer);
            isRunning = false;
        }

        function resetTimer() {
            clearInterval(timer);
            isRunning = false;
            minutes = 25;
            seconds = 0;
            updateTimerDisplay();
        }

        startBtn.addEventListener('click', startTimer);
        pauseBtn.addEventListener('click', pauseTimer);
        resetBtn.addEventListener('click', resetTimer);

        // Gestión de Metas
        const goalModal = document.getElementById('goalModal');
        const goalModalTitle = document.getElementById('goalModalTitle');
        const goalSubmitBtn = document.getElementById('goalSubmitBtn');
        const addGoalBtn = document.getElementById('addGoalBtn');
        const closeGoalModal = document.getElementById('closeGoalModal');
        const goalForm = document.getElementById('goalForm');
        const goalId = document.getElementById('goalId');
        const goalTitle = document.getElementById('goalTitle');
        const goalDescription = document.getElementById('goalDescription');
        const goalTarget = document.getElementById('goalTarget');
        const goalCurrent = document.getElementById('goalCurrent');
        const goalsList = document.getElementById('goalsList');

        function renderGoals() {
            goalsList.innerHTML = '';
            goals.forEach((goal, index) => {
                const percentage = Math.round((goal.current / goal.target) * 100);
                const goalDiv = document.createElement('div');
                goalDiv.className = 'goal-item fade-in';
                goalDiv.innerHTML = `
                    <div class="goal-header">
                        <div class="goal-title">${goal.title}</div>
                        <div class="task-actions">
                            <button class="edit-goal" data-index="${index}" title="Editar meta">✎</button>
                            <button class="delete-goal" data-index="${index}" title="Eliminar meta">✕</button>
                        </div>
                    </div>
                    <p style="color: var(--gray); margin-bottom: 10px;">${goal.description}</p>
                    <div class="goal-progress">
                        <div class="goal-progress-bar" style="width: ${percentage}%"></div>
                    </div>
                    <div class="goal-percentage">${goal.current} / ${goal.target} (${percentage}%)</div>
                    <div style="margin-top: 10px;">
                        <button class="timer-btn start-btn" onclick="updateGoalProgress(${index}, 1)">+1</button>
                        <button class="timer-btn pause-btn" onclick="updateGoalProgress(${index}, -1)">-1</button>
                    </div>
                `;
                goalsList.appendChild(goalDiv);

                // Agregar event listeners para editar y eliminar
                goalDiv.querySelector('.edit-goal').addEventListener('click', () => editGoal(index));
                goalDiv.querySelector('.delete-goal').addEventListener('click', () => deleteGoal(index));
            });
            saveGoals();
        }

        function updateGoalProgress(index, change) {
            goals[index].current = Math.max(0, Math.min(goals[index].target, goals[index].current + change));
            renderGoals();
        }

        function addGoal(title, description, target, current = 0) {
            goals.push({
                id: Date.now().toString(),
                title,
                description,
                target: parseInt(target),
                current: parseInt(current),
                createdAt: new Date().toISOString()
            });
            renderGoals();
        }

        function editGoal(index) {
            const goal = goals[index];
            goalModalTitle.textContent = 'Editar Meta';
            goalSubmitBtn.textContent = 'Actualizar Meta';
            goalId.value = goal.id;
            goalTitle.value = goal.title;
            goalDescription.value = goal.description;
            goalTarget.value = goal.target;
            goalCurrent.value = goal.current;
            editingGoalIndex = index;
            goalModal.style.display = 'block';
        }

        function updateGoal(id, title, description, target, current) {
            const index = goals.findIndex(goal => goal.id === id);
            if (index !== -1) {
                goals[index].title = title;
                goals[index].description = description;
                goals[index].target = parseInt(target);
                goals[index].current = parseInt(current);
                goals[index].updatedAt = new Date().toISOString();
                renderGoals();
            }
        }

        function deleteGoal(index) {
            if (confirm('¿Estás seguro de eliminar esta meta?')) {
                goals.splice(index, 1);
                renderGoals();
            }
        }

        function saveGoals() {
            localStorage.setItem('goals', JSON.stringify(goals));
        }

        addGoalBtn.addEventListener('click', () => {
            goalModalTitle.textContent = 'Nueva Meta';
            goalSubmitBtn.textContent = 'Crear Meta';
            goalForm.reset();
            goalId.value = '';
            editingGoalIndex = -1;
            goalModal.style.display = 'block';
        });

        closeGoalModal.addEventListener('click', () => {
            goalModal.style.display = 'none';
            goalForm.reset();
        });

        goalForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const title = goalTitle.value;
            const description = goalDescription.value;
            const target = goalTarget.value;
            const current = goalCurrent.value;
            const id = goalId.value;

            if (id) {
                updateGoal(id, title, description, target, current);
            } else {
                addGoal(title, description, target, current);
            }
            goalModal.style.display = 'none';
            goalForm.reset();
        });

        // Gestión del Calendario
        const eventModal = document.getElementById('eventModal');
        const addEventBtn = document.getElementById('addEventBtn');
        const closeEventModal = document.getElementById('closeEventModal');
        const eventForm = document.getElementById('eventForm');
        const currentMonthEl = document.getElementById('currentMonth');
        const prevMonthBtn = document.getElementById('prevMonth');
        const nextMonthBtn = document.getElementById('nextMonth');
        const calendarGrid = document.getElementById('calendarGrid');
        const eventsList = document.getElementById('eventsList');

        const monthNames = [
            'Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',
            'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'
        ];

        const dayNames = ['Dom', 'Lun', 'Mar', 'Mié', 'Jue', 'Vie', 'Sáb'];

        function renderCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();

            currentMonthEl.textContent = `${monthNames[month]} ${year}`;

            // Obtener primer día del mes y número de días
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();

            // Limpiar grid
            calendarGrid.innerHTML = '';

            // Agregar encabezados de días
            for (let i = 0; i < 7; i++) {
                const dayHeader = document.createElement('div');
                dayHeader.className = 'calendar-day-header';
                dayHeader.textContent = dayNames[i];
                calendarGrid.appendChild(dayHeader);
            }

            // Agregar días vacíos al inicio
            for (let i = 0; i < firstDay; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day';
                calendarGrid.appendChild(emptyDay);
            }

            // Agregar días del mes
            const today = new Date();
            for (let i = 1; i <= daysInMonth; i++) {
                const day = document.createElement('div');
                day.className = 'calendar-day';
                day.textContent = i;

                // Comprobar si es hoy
                if (i === today.getDate() && month === today.getMonth() && year === today.getFullYear()) {
                    day.classList.add('today');
                }

                // Comprobar si hay eventos en este día
                const dateStr = `${year}-${(month + 1).toString().padStart(2, '0')}-${i.toString().padStart(2, '0')}`;
                const dayEvents = events.filter(event => event.date === dateStr);
                if (dayEvents.length > 0) {
                    day.classList.add('has-event');
                    day.title = `${dayEvents.length} evento(s)`;
                }

                day.addEventListener('click', () => showDayEvents(dateStr));
                calendarGrid.appendChild(day);
            }
        }

        function showDayEvents(dateStr) {
            const dayEvents = events.filter(event => event.date === dateStr);
            eventsList.innerHTML = '';

            if (dayEvents.length === 0) {
                eventsList.innerHTML = '<p>No hay eventos para este día</p>';
                return;
            }

            dayEvents.forEach(event => {
                const eventItem = document.createElement('div');
                eventItem.className = 'event-item';
                eventItem.innerHTML = `
                    <strong>${event.title}</strong>
                    ${event.time ? `<br><small>${event.time}</small>` : ''}
                    ${event.description ? `<p>${event.description}</p>` : ''}
                `;
                eventsList.appendChild(eventItem);
            });
        }

        function prevMonth() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar();
        }

        function nextMonth() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar();
        }

        function addEvent(title, date, time, description) {
            events.push({
                id: Date.now().toString(),
                title,
                date,
                time,
                description,
                createdAt: new Date().toISOString()
            });
            saveEvents();
            renderCalendar();
        }

        function saveEvents() {
            localStorage.setItem('events', JSON.stringify(events));
        }

        prevMonthBtn.addEventListener('click', prevMonth);
        nextMonthBtn.addEventListener('click', nextMonth);

        addEventBtn.addEventListener('click', () => {
            eventForm.reset();
            // Establecer fecha actual por defecto
            const today = new Date();
            document.getElementById('eventDate').value = today.toISOString().split('T')[0];
            eventModal.style.display = 'block';
        });

        closeEventModal.addEventListener('click', () => {
            eventModal.style.display = 'none';
        });

        eventForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const title = document.getElementById('eventTitle').value;
            const date = document.getElementById('eventDate').value;
            const time = document.getElementById('eventTime').value;
            const description = document.getElementById('eventDescription').value;

            addEvent(title, date, time, description);
            eventModal.style.display = 'none';
        });

        // Gestión de Notas
        const noteModal = document.getElementById('noteModal');
        const noteModalTitle = document.getElementById('noteModalTitle');
        const noteSubmitBtn = document.getElementById('noteSubmitBtn');
        const addNoteBtn = document.getElementById('addNoteBtn');
        const closeNoteModal = document.getElementById('closeNoteModal');
        const noteForm = document.getElementById('noteForm');
        const noteId = document.getElementById('noteId');
        const noteContent = document.getElementById('noteContent');
        const notesContainer = document.getElementById('notesContainer');

        function renderNotes() {
            notesContainer.innerHTML = '';
            notes.forEach((note, index) => {
                const noteDiv = document.createElement('div');
                noteDiv.className = 'note fade-in';
                noteDiv.innerHTML = `
                    <div class="note-content">${note.content}</div>
                    <div class="note-actions">
                        <button class="edit-note" data-index="${index}" title="Editar nota">✎</button>
                        <button class="delete-note" data-index="${index}" title="Eliminar nota">✕</button>
                    </div>
                `;
                notesContainer.appendChild(noteDiv);

                // Agregar event listeners para editar y eliminar
                noteDiv.querySelector('.edit-note').addEventListener('click', () => editNote(index));
                noteDiv.querySelector('.delete-note').addEventListener('click', () => deleteNote(index));
            });
            saveNotes();
        }

        function addNote(content) {
            notes.push({
                id: Date.now().toString(),
                content,
                createdAt: new Date().toISOString()
            });
            renderNotes();
        }

        function editNote(index) {
            const note = notes[index];
            noteModalTitle.textContent = 'Editar Nota';
            noteSubmitBtn.textContent = 'Actualizar Nota';
            noteId.value = note.id;
            noteContent.value = note.content;
            editingNoteIndex = index;
            noteModal.style.display = 'block';
        }

        function updateNote(id, content) {
            const index = notes.findIndex(note => note.id === id);
            if (index !== -1) {
                notes[index].content = content;
                notes[index].updatedAt = new Date().toISOString();
                renderNotes();
            }
        }

        function deleteNote(index) {
            if (confirm('¿Estás seguro de eliminar esta nota?')) {
                notes.splice(index, 1);
                renderNotes();
            }
        }

        function saveNotes() {
            localStorage.setItem('notes', JSON.stringify(notes));
        }

        addNoteBtn.addEventListener('click', () => {
            noteModalTitle.textContent = 'Nueva Nota';
            noteSubmitBtn.textContent = 'Crear Nota';
            noteForm.reset();
            noteId.value = '';
            editingNoteIndex = -1;
            noteModal.style.display = 'block';
        });

        closeNoteModal.addEventListener('click', () => {
            noteModal.style.display = 'none';
            noteForm.reset();
        });

        noteForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const content = noteContent.value;
            const id = noteId.value;

            if (id) {
                updateNote(id, content);
            } else {
                addNote(content);
            }
            noteModal.style.display = 'none';
            noteForm.reset();
        });

        // Gestión del Clima
        const weatherInfo = document.getElementById('weatherInfo');
        const getWeatherBtn = document.getElementById('getWeatherBtn');

        function getWeather() {
            // Simulación de datos del clima (en una app real, usarías una API)
            const weatherData = {
                temperature: Math.floor(Math.random() * 30) + 10,
                condition: 'Parcialmente nublado',
                humidity: Math.floor(Math.random() * 50) + 30,
                windSpeed: Math.floor(Math.random() * 20) + 5
            };

            weatherInfo.innerHTML = `
                <div class="weather-icon">🌤️</div>
                <div class="temperature">${weatherData.temperature}°C</div>
                <div>${weatherData.condition}</div>
                <div class="weather-details">
                    <div class="weather-detail">
                        <div>💧 Humedad</div>
                        <div>${weatherData.humidity}%</div>
                    </div>
                    <div class="weather-detail">
                        <div>💨 Viento</div>
                        <div>${weatherData.windSpeed} km/h</div>
                    </div>
                </div>
            `;
        }

        getWeatherBtn.addEventListener('click', getWeather);

        // Función de notificación
        function showNotification(title, message) {
            if ('Notification' in window && Notification.permission === 'granted') {
                new Notification(title, { body: message });
            } else if ('Notification' in window && Notification.permission !== 'denied') {
                Notification.requestPermission().then(permission => {
                    if (permission === 'granted') {
                        new Notification(title, { body: message });
                    }
                });
            }

            // Mostrar también una alerta simple como respaldo
            alert(`${title}\n${message}`);
        }

        // Inicialización
        function init() {
            loadPreferences();
            renderTasks();
            updateTimerDisplay();
            renderGoals();
            renderCalendar();
            renderNotes();

            // Solicitar permisos para notificaciones
            if ('Notification' in window) {
                Notification.requestPermission();
            }
        }

        // Iniciar la aplicación
        init();
    </script>
</body>
</html>